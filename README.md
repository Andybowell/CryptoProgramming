# CryptoProgramming
Write one programs in three SEPARATE directories: a key generation program, a sender’s program, and a receiver’s program, to implement ONE of the following options of simplified cryptographic applications. Except for the file named “symmetric.key” (a text file), ALL other files MUST be treated as binary files in I/O operations and handled by either ObjectInputStream & ObjectOutputStream (for public/private key files) or BufferedInputStream & BufferedOutputStream (for various message files).
• In the key generation program (required for EACH of Options 1, 2, and 3) in the directory “KeyGen”,
1. Create a pair of RSA public and pr ivate keys for X, Kx+ and Kx–;
2. Create a pair of RSA public and private keys for Y, Ky+ and Ky–;
3. Get the modulus and exponent of each RSA public or private key and save them into files named “XPublic.key”, “XPrivate.key”, “YPublic.key”, and “YPrivate.key”, respectively;
4. Take a 16-character user input from the keyboard and save this 16-character string to a file named “symmetric.key”. This string’s 128-bit UTF-8 encoding will be used as the 128-bit AES symmetric key, Kxy, in your application



Digital envelope including keyed hash MAC

• In this option, X is the sender, Y is the receiver, Kxy is the random symmetric key generated by X.
• In the sender’s program in the directory “Sender”, calculate SHA256 (Kxy || M || Kxy), AES-En Kxy (M), and RSA-En Ky+ (Kxy)
1 To test this program, the corresponding key files need to be copied here from the directory “KeyGen”
2 Read the information on the keys to be used in this program from the key files and generate Ky+ and Kxy.
MSU Denver, M&CS CS 3750: Computer and Network Security, Fall 2020 Dr. Weiying Zhu
3 Display a prompt “Input the name of the message file:” and take a user input from the keyboard. This user input provides the name of the file containing the message M. M can NOT be assumed to be a text message. The size of the message M could be much larger than 32KB.
4 WRITE Kxy to a file named “message.kmk”, read the message M from the file specified in Step 3 piece by piece, APPEND M to the file “message.kmk”, and finally APPEND Kxy to the file “message.kmk”.
5 Read Kxy || M || Kxy piece by piece from the file “message.kmk”, where each piece is recommended to be a small multiple of 1024 bytes, calculate the keyed hash MAC, i.e., the SHA256 hash value of (Kxy || M || Kxy), SAVE this keyed hash MAC into a file named “message.khmac”, and DISPLAY it in Hexadecimal bytes.
o An added feature for testing whether the receiver’s program can handle the case properly when the keyed hash MAC calculated in Step 6 (the receiver’s program) is different from the keyed hash MAC in the “message.khmac” file: After calculating SHA256(Kxy || M || Kxy) but before saving it to the file named “message.khmac” (the sender’s program), display a prompt “Do you want to invert the 1st byte in SHA256(Kxy||M||Kxy)? (Y or N)”,
o If the user input is ‘Y’, modify the first byte in your byte array holding SHA256(Kxy || M || Kxy) by replacing it with its bitwise inverted value (hint: the ~ operator in Java does it), complete the rest of Step 5 by SAVING & DISPLAYING the modified SHA256(Kxy || M || Kxy), instead of the original SHA256(Kxy || M || Kxy), and continue to Step 6 (also use the modified SHA256(Kxy || M || Kxy), instead of the original SHA256(Kxy || M || Kxy), in Steps 6 & 7).
o Otherwise (if the user input is ‘N’), make NO change to the byte array holding SHA256(Kxy || M || Kxy), complete the rest of Step 5 (SAVE and DISPLAY), and continue to Step 6.
6 Calculate the AES Encryption of M using Kxy by reading the file specified in Step 3 piece by piece, where each piece is recommended to be a multiple of 16 bytes long. (Hint: if the length of the last piece is less than that multiple of 16 bytes, it needs to be placed in a byte array whose array size is the length of the last piece before being encrypted.) SAVE the resulting blocks of AES ciphertext into a file named “message.aescipher”.
7 Calculate the RSA Encryption of Kxy using Ky+. (Hint: if "RSA/ECB/PKCS1Padding" is used, what is the length of the resulting ciphertext?) SAVE the resulting RSA ciphertext into a file named “kxy.rsacipher”.
• In the receiver’s program in the directory “Receiver”, use RSA Decryption to get Kxy, use AES Decryption to get M, compare SHA256(Kxy || M || Kxy) with the locally calculated SHA256 hash of (Kxy || M || Kxy), and report hashing error if any.
1 To test this program, the corresponding key files need to be copied here from the directory “KeyGen”, and the files “message.khmac”, “message.aescipher”, and “kxy.rsacipher” need to be copied here from the directory “Sender”. (Hint: the file “symmetric.key” should NOT be copied here from the directory “KeyGen”.)
2 Read the information on the keys to be used in this program from the key file and generate Ky–.
3 Display a prompt “Input the name of the message file:” and take a user input from the keyboard. The resulting message M will be saved to this file at the end of this program.
4 Read the ciphertext, C1, from the file “kxy.rsacipher”. Calculate the RSA Decryption of C1 using Ky– to get the random symmetric key Kxy, SAVE Kxy to a file named “message.kmk”, and DISPLAY Kxy in Hexadecimal bytes.
5 Read the ciphertext, C2, from the file “message.aescipher” block by block, where each block needs to be a multiple of 16 bytes long. (Hint: if the length of the last block is less than that multiple of 16 bytes, it needs to be placed in a byte array whose array size is the length of the last piece before being decrypted.) Calculate the AES Decryption of C2 block by block using the Kxy obtained in Step 4 to get M, WRITE the resulting pieces of M into the file specified in Step 3, and also APPEND those resulting pieces of M to the file “message.kmk” created in Step 4. Finally APPEND Kxy after M to the file “message.kmk”. (Hint: at the end of this Step, Kxy || M || Kxy is written to the file “message.kmk”, and M is written to the file specified in Step 3.)
6 Read Kxy || M || Kxy piece by piece from the file “message.kmk”, where each piece is recommended to be a small multiple of 1024 bytes, calculate the keyed hash MAC, i.e., the SHA256 hash value of (Kxy || M || Kxy), COMPARE this keyed hash MAC with the keyed hash MAC read from the file “message.khmac”, DISPLAY whether it passes the message authentication checking, and DISPLAY both keyed hash MACs in Hexadecimal bytes.
